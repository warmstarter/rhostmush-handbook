{"parents": [], "prev": {"link": "../maintenance/", "title": "<span class=\"section-number\">8. </span>Maintenance"}, "next": {"link": "../advanced/", "title": "<span class=\"section-number\">10. </span>Advanced Features"}, "title": "<span class=\"section-number\">9. </span>Troubleshooting", "meta": {}, "body": "<div class=\"section\" id=\"troubleshooting\">\n<h1><span class=\"section-number\">9. </span>Troubleshooting<a class=\"headerlink\" href=\"#troubleshooting\" title=\"Permalink to this headline\">\u00b6</a></h1>\n<div class=\"section\" id=\"reporting-bugs-or-getting-help\">\n<h2><span class=\"section-number\">9.1. </span>Reporting bugs or getting help<a class=\"headerlink\" href=\"#reporting-bugs-or-getting-help\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>If you find any bugs or problems, notify one of the developers of RhostMUSH and\na patch or workaround will be made available as soon as possible.  Current\ndevelopers are:  Seawolf, Thorin, Ashen-Shugar, Lensman, Kale, Mac, Zenty,\nAmbrosia, Amos, and Morgan.  They can be found around the net.</p>\n<div class=\"section\" id=\"troubleshooting-issues-with-starting-up\">\n<h3><span class=\"section-number\">9.1.1. </span>Troubleshooting issues with starting up<a class=\"headerlink\" href=\"#troubleshooting-issues-with-starting-up\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<div class=\"section\" id=\"problem-if-it-says-the-shared-id-is-already-in-use\">\n<h4><span class=\"section-number\">9.1.1.1. </span>Problem: If it says the shared ID is already in use<a class=\"headerlink\" href=\"#problem-if-it-says-the-shared-id-is-already-in-use\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>A1: please verify that it is the right shared debug_id in your netrhost.conf file</p>\n<p>A2: Force a start by running:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"o\">./</span><span class=\"n\">Startmush</span> <span class=\"o\">-</span><span class=\"n\">f</span>\n</pre></div>\n</div>\n</div>\n<div class=\"section\" id=\"problem-your-log-file-is-massive-and-your-mush-is-running\">\n<h4><span class=\"section-number\">9.1.1.2. </span>Problem: Your log file is massive and your mush is running<a class=\"headerlink\" href=\"#problem-your-log-file-is-massive-and-your-mush-is-running\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>A1: To rotate this use the &#64;logrotate command. See wizhelp on &#64;logrotate</p>\n</div>\n<div class=\"section\" id=\"problem-the-database-flatfile-you-re-loading-can-t-load-because-a-db-is-already-defined\">\n<h4><span class=\"section-number\">9.1.1.3. </span>Problem: The database flatfile you\u2019re loading can\u2019t load because a db is already defined<a class=\"headerlink\" href=\"#problem-the-database-flatfile-you-re-loading-can-t-load-because-a-db-is-already-defined\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>A1: remove netrhost.db* and netrhost.gdbm* from your data directory</p>\n</div>\n<div class=\"section\" id=\"problem-the-mail-database-won-t-load-and-mail-shows-offline\">\n<h4><span class=\"section-number\">9.1.1.4. </span>Problem: The mail database won\u2019t load and mail shows \u2018offline\u2019<a class=\"headerlink\" href=\"#problem-the-mail-database-won-t-load-and-mail-shows-offline\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>A1: from within the MUSH run:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">wmail</span><span class=\"o\">/</span><span class=\"n\">load</span>\n</pre></div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"section\" id=\"stack-limit-and-debugging\">\n<h2><span class=\"section-number\">9.2. </span>Stack limit and debugging<a class=\"headerlink\" href=\"#stack-limit-and-debugging\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>Rhost uses a stack limit in the debug monitor.</p>\n<p>This stack limit is set to a reasonable amount of 1000.\nThis is defined in the debug.h file in the hdrs directory.</p>\n<p>This will directly impact the function_recursion_limit from being\nset above 100.  If, for whatever reason, you really must have\na ridiculously high recursion limit, then it is a suggestion to\nmanually modify the stack limit in debug.h to a higher number.</p>\n<p>We have reasonably set it to 10000 without too much issue, but keep\nin mind, the overhead is higher for every stack you throw on the\nprocess table.  Higher stack means more memory used.</p>\n<p>Also be aware that your shell stack limit directly is affected\nto this value.</p>\n<p>Type:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">ulimit</span> <span class=\"o\">-</span><span class=\"n\">a</span>\n</pre></div>\n</div>\n<p>This will show you your shell stack limits.  Do NOT set the\nSTACKMAX value higher than your shell\u2019s stack value.</p>\n<p>The value in ~/Rhost/Server/hdrs/debug.h is currently set as:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\">#define STACKMAX 1000</span>\n</pre></div>\n</div>\n<p>Feel free to change this to a higher value if you wish.</p>\n<p>The caveat.  This effects the debug stack daemon.  Meaning,\nthe only way for this to be updated is through &#64;shutdown and\nthen a fresh ./Startmush.</p>\n<p>A &#64;reboot WILL NOT LOAD IN A NEW DEBUG MONITOR!!!!</p>\n<p>You can issue &#64;list stack to see the current stack ceiling ingame.</p>\n</div>\n<div class=\"section\" id=\"how-to-reset-the-password-for-1\">\n<h2><span class=\"section-number\">9.3. </span>How to reset the password for #1<a class=\"headerlink\" href=\"#how-to-reset-the-password-for-1\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<div class=\"admonition warning\">\n<p class=\"admonition-title\">Warning</p>\n<p>You can only use one of these options at a time. Make sure to change back your nerhost.conf and then reboot after making the changes.</p>\n</div>\n<div class=\"section\" id=\"method-1-reset-to-default-password\">\n<h3><span class=\"section-number\">9.3.1. </span>Method 1: Reset to Default Password<a class=\"headerlink\" href=\"#method-1-reset-to-default-password\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>in your netrhost.conf file add:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">newpass_god</span> <span class=\"mi\">777</span>\n</pre></div>\n</div>\n<p>This will reset #1\u2019s password to the default \u2018Nyctasia\u2019.</p>\n</div>\n<div class=\"section\" id=\"method-2-increase-permissions-of-immortals\">\n<h3><span class=\"section-number\">9.3.2. </span>Method 2: Increase Permissions of Immortals<a class=\"headerlink\" href=\"#method-2-increase-permissions-of-immortals\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>in your netrhost.conf file add:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">newpass_god</span> <span class=\"mi\">1</span>\n</pre></div>\n</div>\n<p>This will allow IMMORTAL players to &#64;newpassword #1 upon reboot.</p>\n</div>\n</div>\n<div class=\"section\" id=\"troubleshooting-difficulties-compiling-rhostmush\">\n<h2><span class=\"section-number\">9.4. </span>Troubleshooting difficulties compiling RhostMUSH<a class=\"headerlink\" href=\"#troubleshooting-difficulties-compiling-rhostmush\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<div class=\"section\" id=\"changes-to-conf-for-high-bit-cpus\">\n<h3><span class=\"section-number\">9.4.1. </span>Changes to conf for high-bit CPUs<a class=\"headerlink\" href=\"#changes-to-conf-for-high-bit-cpus\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>RhostMUSH automatically detects 64-bit platforms, and should compile\ncleanly on these.</p>\n<p>In case you are trying to compile Rhost on some other crazy-wide CPUs\nsuch as the PS2, PS3 or other 128 or 256 bit CPUs, you can easily do\nso by changing a few lines of code in conf.c.</p>\n<p>change:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">typedef</span> <span class=\"n\">unsigned</span> <span class=\"nb\">int</span>    <span class=\"n\">pmath1</span><span class=\"p\">;</span>\n<span class=\"n\">typedef</span> <span class=\"nb\">int</span>             <span class=\"n\">pmath2</span><span class=\"p\">;</span>\n<span class=\"c1\">#define ALLIGN1 4</span>\n</pre></div>\n</div>\n<p>to:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">typedef</span> <span class=\"n\">unsigned</span> <span class=\"n\">long</span>   <span class=\"n\">pmath1</span><span class=\"p\">;</span>\n<span class=\"n\">typedef</span> <span class=\"n\">long</span>            <span class=\"n\">pmath2</span><span class=\"p\">;</span>\n<span class=\"c1\">#define ALLIGN1 8</span>\n</pre></div>\n</div>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>Replace 8 with the size of your CPU\u2019s long integer. (4 for 32-bit,\n8 for 64-bit, 16 for 128-bit, etc etc)</p>\n</div>\n<p>RhostMUSH has only been tested to work on the AMD64, but there is no\nreason to believe the same will not hold true for IA64.</p>\n</div>\n<div class=\"section\" id=\"changes-to-autconf-for-certain-systems\">\n<h3><span class=\"section-number\">9.4.2. </span>Changes to autconf for certain systems<a class=\"headerlink\" href=\"#changes-to-autconf-for-certain-systems\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>You should not have to worry about this, but incase something really\nweird occurs, you may need to look into these changes\u2026</p>\n<p>The autoconfig.h file needs to have modifications to it by hand.</p>\n<p>There are three manual entries:</p>\n<p>This one sets how it defines the int to character pointer.  It\u2019s safe\nto keep it as \u2018unsigned int\u2019 for 32 bit platforms.  For non 32-bit,\ndefine it to  how an int is defined on that system:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">typedef</span> <span class=\"n\">unsigned</span> <span class=\"nb\">int</span>    <span class=\"n\">pmath1</span><span class=\"p\">;</span>\n</pre></div>\n</div>\n<p>This one sets how it defines the signed int to character pointer.  Same\nrestrictions apply as above for unsigned int:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">typedef</span> <span class=\"nb\">int</span>     <span class=\"n\">pmath2</span><span class=\"p\">;</span>\n</pre></div>\n</div>\n<p>This sets the allignment for the given platform.  4 represents a 32 bit\nplatform.  8 would represent a 64 bit platform, etc.  Change accordingly:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\">#define ALLIGN1 4</span>\n</pre></div>\n</div>\n<div class=\"admonition warning\">\n<p class=\"admonition-title\">Warning</p>\n<p>Make sure these three entries are defined in your autoconf.h file else\nthe mush will not compile.</p>\n</div>\n</div>\n</div>\n<div class=\"section\" id=\"dealing-with-db-corruption\">\n<h2><span class=\"section-number\">9.5. </span>Dealing with DB Corruption<a class=\"headerlink\" href=\"#dealing-with-db-corruption\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>Ok.  Your database won\u2019t come up.</p>\n<p>If you are reading this, then likely the scenerio is one of the following:</p>\n<ol class=\"arabic simple\">\n<li><p>The mush says it can\u2019t find your database files.</p></li>\n<li><p>The mush says it can\u2019t read or load your database files.</p></li>\n<li><p>The mush seems to load fine but I can\u2019t log in anyone and when I do\nall the names and attributes of things seem to be gone!</p></li>\n<li><p>Bringing up your mail database</p></li>\n</ol>\n<p>First thing is first.  Don\u2019t have a panic attack.</p>\n<div class=\"section\" id=\"if-the-mush-says-it-can-t-find-your-database-files\">\n<h3><span class=\"section-number\">9.5.1. </span>If the mush says it can\u2019t find your database files<a class=\"headerlink\" href=\"#if-the-mush-says-it-can-t-find-your-database-files\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<div class=\"section\" id=\"check-the-names-of-the-database-files-in-your-data-directory\">\n<h4><span class=\"section-number\">9.5.1.1. </span>Check the names of the database files in your \u2018data\u2019 directory<a class=\"headerlink\" href=\"#check-the-names-of-the-database-files-in-your-data-directory\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>They should be named something like:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">netrhost</span><span class=\"o\">.</span><span class=\"n\">db</span>\n<span class=\"n\">netrhost</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">old</span>\n<span class=\"n\">netrhost</span><span class=\"o\">.</span><span class=\"n\">db</span><span class=\"o\">.</span><span class=\"n\">old</span><span class=\"o\">.</span><span class=\"n\">prev</span>\n<span class=\"n\">netrhost</span><span class=\"o\">.</span><span class=\"n\">gdbm</span><span class=\"o\">.</span><span class=\"n\">dir</span>\n<span class=\"n\">netrhost</span><span class=\"o\">.</span><span class=\"n\">gdbm</span><span class=\"o\">.</span><span class=\"n\">pag</span>\n</pre></div>\n</div>\n<p>And you may see a netrhost.db.flat</p>\n</div>\n<div class=\"section\" id=\"check-your-netrhost-conf-file\">\n<h4><span class=\"section-number\">9.5.1.2. </span>Check your netrhost.conf file<a class=\"headerlink\" href=\"#check-your-netrhost-conf-file\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>If you never touched the *database or muddb_name params, you should be good.</p>\n<p>Verify your *database params (and muddb_name) are still set to \u2018netrhost\u2019 as\npart of the name.  Ergo, the default values and you didn\u2019t change them.\nThese should match up with the filenames in your data directory.</p>\n<p>If these names do not match up, it can\u2019t find the database files to load.\nSo you shouldn\u2019t have to change these names, ever. :)</p>\n</div>\n<div class=\"section\" id=\"check-your-mush-config-file\">\n<h4><span class=\"section-number\">9.5.1.3. </span>Check your mush.config file<a class=\"headerlink\" href=\"#check-your-mush-config-file\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>If you never modified this file, you should be good.</p>\n<p>The gamename should be \u2018netrhost\u2019 for this file.  This does NOT control\nthe name of your game.  This controls the name of all the files\nas associated to the mush.  So changing this means the netrhost.conf\nfile, all your database files, and so forth.  Please don\u2019t change this :)</p>\n</div>\n</div>\n<div class=\"section\" id=\"if-the-mush-says-it-can-t-read-or-load-your-database-files\">\n<h3><span class=\"section-number\">9.5.2. </span>If the mush says it can\u2019t read or load your database files<a class=\"headerlink\" href=\"#if-the-mush-says-it-can-t-read-or-load-your-database-files\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Double check everything for the previous issue. Make sure everything is named properly.</p>\n<div class=\"section\" id=\"verify-you-have-enough-disk-space-quota\">\n<h4><span class=\"section-number\">9.5.2.1. </span>Verify you have enough disk space. (quota)<a class=\"headerlink\" href=\"#verify-you-have-enough-disk-space-quota\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>Some account have a limited quota to run in.  If you reached or exceed\nyour disk quota, you can have a corrupted database.  So always keep\nyour eye on the size.  quota -s to see a human readable format to see\nhow much quota you have left.  You want to make sure current in use is\nbelow the \u2018grace\u2019 and soft/hard limits shown.  If not, you\u2019re out of\nspace.</p>\n<p>You will need to remove some files before you repair and bring up your\nmush again.  Try to keep your quota at least 200 megs free to allow\nplenty of wonderful growth space for the mush.</p>\n</div>\n<div class=\"section\" id=\"verify-you-have-enough-disk-space-system\">\n<h4><span class=\"section-number\">9.5.2.2. </span>Verify you have enough disk space.  (system)<a class=\"headerlink\" href=\"#verify-you-have-enough-disk-space-system\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>The second way you can run out of disk space is by the filesystem itself.\ndo a df -h . in your \u2018game\u2019 directory\u2019.  That is df -h &lt;period&gt;.\nThis will return how much disk space is being used and how much remains.\nIf it shows 100% used, you\u2019re out of disk space and the db is corrupt.</p>\n<p>At this point, you\u2019re pretty screwed.  You can see if anything exists\nin your system to free up some space, but if the filesystem itself\nis filled, reach out to the owner of the server and let them know.\nIt\u2019s a much bigger deal than just your mush if that\u2019s the case.</p>\n<p>Until this issue is resolved, you can not repair and bring up your mush.\nNo disk to run the game.</p>\n</div>\n</div>\n<div class=\"section\" id=\"if-the-mush-seems-to-load-fine-but-i-can-t-log-in-anyone-and-when-i-do-all-the-names-and-attributes-of-things-seem-to-be-gone\">\n<h3><span class=\"section-number\">9.5.3. </span>If the mush seems to load fine but I can\u2019t log in anyone and when I do all the names and attributes of things seem to be gone!<a class=\"headerlink\" href=\"#if-the-mush-seems-to-load-fine-but-i-can-t-log-in-anyone-and-when-i-do-all-the-names-and-attributes-of-things-seem-to-be-gone\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Ok, at this point you likely had your mush up when the physical server\nwent down hard.  Weither through an emergency shutdown or a physical\npower outage, your db likely was brought down hard during a write,\nso it left it in a corrupt state.  These things happen.  This is\nwhy we always strongly request you make daily flatfile dumps.</p>\n<p>So, to recover your database.</p>\n<div class=\"section\" id=\"the-bad-news\">\n<h4><span class=\"section-number\">9.5.3.1. </span>The bad news<a class=\"headerlink\" href=\"#the-bad-news\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>If you have no flatfile backup or never bothered with backups?\nI\u2019m sorry, at this point you\u2019re SOA.  There\u2019s no easy way to\nrecover a corrupted binary database.  If you absolutely need\ndata out of it we may be able to help you to piece meal things\nout of it, but otherwise it\u2019s a lost cause.  You\u2019ll have to start\nover from scratch.  I\u2019m sorry.</p>\n</div>\n<div class=\"section\" id=\"the-good-news\">\n<h4><span class=\"section-number\">9.5.3.2. </span>The good news<a class=\"headerlink\" href=\"#the-good-news\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>If you made backups, or if the server had a normal shutdown, you\nlikely have a flatfile backup.  You will see a netrhost.db.flat\nin either the \u2018data\u2019 directory or \u2018prevflat\u2019 directory.  That\nis your manual flatfile backup.</p>\n<p>If the server had a normal shutdown, you will see a file called\nnetrhost.db.TERMFLAT.  This is a scram-emergency db flatfile.\nIt attempts to write this at the time of server shutdown to\nhopefully keep a clean backup in the case of issues since\nit identifies the server is coming down hard.  Make sure\nif you plan to use the TERMFLAT as your recovery flatfile\nthat the very last line shows something like ** END OF DUMP **.\nThat shows you had a successful backup.</p>\n</div>\n<div class=\"section\" id=\"now-to-restore-your-database\">\n<h4><span class=\"section-number\">9.5.3.3. </span>Now, to restore your database?<a class=\"headerlink\" href=\"#now-to-restore-your-database\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>Please refer to the file \u2018README.DBLOADING\u2019.</p>\n</div>\n</div>\n<div class=\"section\" id=\"bringing-up-your-mail-database\">\n<h3><span class=\"section-number\">9.5.4. </span>Bringing up your mail database<a class=\"headerlink\" href=\"#bringing-up-your-mail-database\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>Your mail db may or may not come up at this point.</p>\n<div class=\"section\" id=\"if-after-restoring-main-database-your-mail-database-works\">\n<h4><span class=\"section-number\">9.5.4.1. </span>If after restoring main database your mail database works<a class=\"headerlink\" href=\"#if-after-restoring-main-database-your-mail-database-works\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>If your mail database came up and does not show\n\u2018Mail: mail is currently off\u2019 then you should be good to go.</p>\n<p>Please issue on the MUSH:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">wmail</span><span class=\"o\">/</span><span class=\"n\">fix</span>\n<span class=\"n\">wmail</span><span class=\"o\">/</span><span class=\"n\">lfix</span>\n</pre></div>\n</div>\n<p>This will put your mail system in sync with your current database and\nfix up any errors that may exist.</p>\n<p>wmail/fix fixes the mail.</p>\n<p>wmail/lfix loads in the fixes.</p>\n</div>\n<div class=\"section\" id=\"if-after-restoring-main-database-your-mail-database-does-not-work\">\n<h4><span class=\"section-number\">9.5.4.2. </span>If after restoring main database your mail database does not work<a class=\"headerlink\" href=\"#if-after-restoring-main-database-your-mail-database-does-not-work\" title=\"Permalink to this headline\">\u00b6</a></h4>\n<p>If your mail database is not up and shows \u2018Mail: mail is currently off\u2019 then your mail db is currupt.</p>\n</div>\n</div>\n</div>\n<div class=\"section\" id=\"dealing-with-a-corrupt-mail-database\">\n<h2><span class=\"section-number\">9.6. </span>Dealing with a corrupt mail database<a class=\"headerlink\" href=\"#dealing-with-a-corrupt-mail-database\" title=\"Permalink to this headline\">\u00b6</a></h2>\n<p>It says when you try to access mail that mail is disabled and/or off.</p>\n<p>Nothing you do can bring it on line.  Well, this is bad, but not horrible.</p>\n<p>The mail db is totally separate from the main game database.  This means\nthat it in no way damaged or corrupted your main mush database.</p>\n<p>The bad news?  Yes.  Your mail database is corrupt.  To bring it back,\nis it hopes that you read ahead of time about how to backup your mush,\nwhich would include the mail database.</p>\n<div class=\"section\" id=\"backing-up-your-mail-database\">\n<h3><span class=\"section-number\">9.6.1. </span>Backing up your mail database<a class=\"headerlink\" href=\"#backing-up-your-mail-database\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>You should be making a flatifile dump of mail db daily by running on the MUSH:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">wmail</span><span class=\"o\">/</span><span class=\"n\">unload</span>\n</pre></div>\n</div>\n<p>To recover your mail, it assumes you have a mail flatfile in either the\n~/Server/game/data directory or the ~/Server/game/prevflat directory.  The\nlatter directory is used in junction to the backup_flat.sh and will always\nhouse the latest flatfile if not one recently dumped in your data directory.</p>\n</div>\n<div class=\"section\" id=\"automatically-recovering-your-mail-database\">\n<h3><span class=\"section-number\">9.6.2. </span>Automatically recovering your mail database<a class=\"headerlink\" href=\"#automatically-recovering-your-mail-database\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>If you have a flatfile dump of your mail db, run this command on the MUSH:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">wmail</span><span class=\"o\">/</span><span class=\"n\">load</span>\n</pre></div>\n</div>\n<p>Yup, that\u2019s it.  It\u2019ll take care of everything else.  Isn\u2019t automation grand?</p>\n<p>Doesn\u2019t even require a reboot :)</p>\n<div class=\"admonition note\">\n<p class=\"admonition-title\">Note</p>\n<p>You may at this point wish to run the following:\nwmail/fix  \u2013 this fixes the mail database and sync\u2019s it to the mush db.\nwmail/lfix \u2013 this loads in the fixed mail database</p>\n</div>\n<p>If you have a very old mail database, this is likely going to be required\nto sync against nuked players and other changes to the game since the flatfile.</p>\n<p>If this is a new db that you have, you can skip the fixing.</p>\n</div>\n<div class=\"section\" id=\"manually-recovering-your-mail-database\">\n<h3><span class=\"section-number\">9.6.3. </span>Manually recovering your mail database<a class=\"headerlink\" href=\"#manually-recovering-your-mail-database\" title=\"Permalink to this headline\">\u00b6</a></h3>\n<p>To recover your mail manually, you need to delete your mail databases,\nreboot, then reload your mail flatfiles.  If you have no mail flatfiles,\nwell, you\u2019re going to have to start over with the mail database.  Sorry.</p>\n<p>First, go into the \u2018game\u2019 subdirectory.  Inside that directory is a \u2018data\u2019\ndirectory.</p>\n<p>You will be deleting all the files with the following names:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">RhostMUSH</span><span class=\"o\">.</span><span class=\"n\">mail</span><span class=\"o\">.*</span>                <span class=\"p\">(</span><span class=\"n\">like</span> <span class=\"n\">RhostMUSH</span><span class=\"o\">.</span><span class=\"n\">mail</span><span class=\"o\">.</span><span class=\"n\">dir</span><span class=\"o\">/</span><span class=\"n\">RhostMUSH</span><span class=\"o\">.</span><span class=\"n\">mail</span><span class=\"o\">.</span><span class=\"n\">pag</span><span class=\"p\">)</span>\n<span class=\"n\">RhostMUSH</span><span class=\"o\">.</span><span class=\"n\">folder</span><span class=\"o\">.*</span>              <span class=\"p\">(</span><span class=\"n\">like</span> <span class=\"n\">RhostMUSH</span><span class=\"o\">.</span><span class=\"n\">folder</span><span class=\"o\">.</span><span class=\"n\">dir</span><span class=\"o\">/</span><span class=\"n\">RhostMUSH</span><span class=\"o\">.</span><span class=\"n\">folder</span><span class=\"o\">.</span><span class=\"n\">pag</span><span class=\"p\">)</span>\n</pre></div>\n</div>\n<div class=\"admonition warning\">\n<p class=\"admonition-title\">Warning</p>\n<p>DO NOT DELETE OTHER NAMED FILES!!!</p>\n</div>\n<p>Once these files are deleted, you may issue a &#64;reboot to restart the mush.\nThis will unlock the mail system and load in a fresh db.</p>\n<p>Now, if you have flatfiles of the old mail database, you will see in either\nthe \u2018data\u2019 directory or the \u2018prevflat\u2019 directory files that are called:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">RhostMUSH</span><span class=\"o\">.</span><span class=\"n\">dump</span><span class=\"o\">.</span><span class=\"n\">folder</span>\n<span class=\"n\">RhostMUSH</span><span class=\"o\">.</span><span class=\"n\">dump</span><span class=\"o\">.</span><span class=\"n\">mail</span>\n</pre></div>\n</div>\n<p>Make sure these two files are in the \u2018data\u2019 subdirectory.  Copy them in\nif they exist in your \u2018prevflat\u2019 directory.</p>\n<p>Once they are in the \u2018data\u2019 directory, within the mush type: wmail/load</p>\n<p>This loads in the flatfile and recover the mail database.</p>\n<p>Now, at this point the mail db may not be 100% in-sync with the game db.</p>\n<p>So let\u2019s fix it.</p>\n<p>wmail/fix   \u2013 this will run a fix on the mail db and repair any issues.</p>\n<p>wmail/lfix  \u2013 this will load the fixed flatfile back into the mush.</p>\n<p>At this point you should be good to go.</p>\n</div>\n</div>\n</div>\n", "metatags": "", "rellinks": [["genindex", "General Index", "I", "index"], ["advanced", "<span class=\"section-number\">10. </span>Advanced Features", "N", "next"], ["maintenance", "<span class=\"section-number\">8. </span>Maintenance", "P", "previous"]], "sourcename": "troubleshooting.rst.txt", "toc": "<ul>\n<li><a class=\"reference internal\" href=\"#\">9. Troubleshooting</a><ul>\n<li><a class=\"reference internal\" href=\"#reporting-bugs-or-getting-help\">9.1. Reporting bugs or getting help</a><ul>\n<li><a class=\"reference internal\" href=\"#troubleshooting-issues-with-starting-up\">9.1.1. Troubleshooting issues with starting up</a><ul>\n<li><a class=\"reference internal\" href=\"#problem-if-it-says-the-shared-id-is-already-in-use\">9.1.1.1. Problem: If it says the shared ID is already in use</a></li>\n<li><a class=\"reference internal\" href=\"#problem-your-log-file-is-massive-and-your-mush-is-running\">9.1.1.2. Problem: Your log file is massive and your mush is running</a></li>\n<li><a class=\"reference internal\" href=\"#problem-the-database-flatfile-you-re-loading-can-t-load-because-a-db-is-already-defined\">9.1.1.3. Problem: The database flatfile you\u2019re loading can\u2019t load because a db is already defined</a></li>\n<li><a class=\"reference internal\" href=\"#problem-the-mail-database-won-t-load-and-mail-shows-offline\">9.1.1.4. Problem: The mail database won\u2019t load and mail shows \u2018offline\u2019</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#stack-limit-and-debugging\">9.2. Stack limit and debugging</a></li>\n<li><a class=\"reference internal\" href=\"#how-to-reset-the-password-for-1\">9.3. How to reset the password for #1</a><ul>\n<li><a class=\"reference internal\" href=\"#method-1-reset-to-default-password\">9.3.1. Method 1: Reset to Default Password</a></li>\n<li><a class=\"reference internal\" href=\"#method-2-increase-permissions-of-immortals\">9.3.2. Method 2: Increase Permissions of Immortals</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#troubleshooting-difficulties-compiling-rhostmush\">9.4. Troubleshooting difficulties compiling RhostMUSH</a><ul>\n<li><a class=\"reference internal\" href=\"#changes-to-conf-for-high-bit-cpus\">9.4.1. Changes to conf for high-bit CPUs</a></li>\n<li><a class=\"reference internal\" href=\"#changes-to-autconf-for-certain-systems\">9.4.2. Changes to autconf for certain systems</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#dealing-with-db-corruption\">9.5. Dealing with DB Corruption</a><ul>\n<li><a class=\"reference internal\" href=\"#if-the-mush-says-it-can-t-find-your-database-files\">9.5.1. If the mush says it can\u2019t find your database files</a><ul>\n<li><a class=\"reference internal\" href=\"#check-the-names-of-the-database-files-in-your-data-directory\">9.5.1.1. Check the names of the database files in your \u2018data\u2019 directory</a></li>\n<li><a class=\"reference internal\" href=\"#check-your-netrhost-conf-file\">9.5.1.2. Check your netrhost.conf file</a></li>\n<li><a class=\"reference internal\" href=\"#check-your-mush-config-file\">9.5.1.3. Check your mush.config file</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#if-the-mush-says-it-can-t-read-or-load-your-database-files\">9.5.2. If the mush says it can\u2019t read or load your database files</a><ul>\n<li><a class=\"reference internal\" href=\"#verify-you-have-enough-disk-space-quota\">9.5.2.1. Verify you have enough disk space. (quota)</a></li>\n<li><a class=\"reference internal\" href=\"#verify-you-have-enough-disk-space-system\">9.5.2.2. Verify you have enough disk space.  (system)</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#if-the-mush-seems-to-load-fine-but-i-can-t-log-in-anyone-and-when-i-do-all-the-names-and-attributes-of-things-seem-to-be-gone\">9.5.3. If the mush seems to load fine but I can\u2019t log in anyone and when I do all the names and attributes of things seem to be gone!</a><ul>\n<li><a class=\"reference internal\" href=\"#the-bad-news\">9.5.3.1. The bad news</a></li>\n<li><a class=\"reference internal\" href=\"#the-good-news\">9.5.3.2. The good news</a></li>\n<li><a class=\"reference internal\" href=\"#now-to-restore-your-database\">9.5.3.3. Now, to restore your database?</a></li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#bringing-up-your-mail-database\">9.5.4. Bringing up your mail database</a><ul>\n<li><a class=\"reference internal\" href=\"#if-after-restoring-main-database-your-mail-database-works\">9.5.4.1. If after restoring main database your mail database works</a></li>\n<li><a class=\"reference internal\" href=\"#if-after-restoring-main-database-your-mail-database-does-not-work\">9.5.4.2. If after restoring main database your mail database does not work</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a class=\"reference internal\" href=\"#dealing-with-a-corrupt-mail-database\">9.6. Dealing with a corrupt mail database</a><ul>\n<li><a class=\"reference internal\" href=\"#backing-up-your-mail-database\">9.6.1. Backing up your mail database</a></li>\n<li><a class=\"reference internal\" href=\"#automatically-recovering-your-mail-database\">9.6.2. Automatically recovering your mail database</a></li>\n<li><a class=\"reference internal\" href=\"#manually-recovering-your-mail-database\">9.6.3. Manually recovering your mail database</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n", "display_toc": true, "page_source_suffix": ".rst", "current_page_name": "troubleshooting", "sidebars": ["localtoc.html", "relations.html", "sourcelink.html", "searchbox.html"], "customsidebar": null, "alabaster_version": "0.7.12", "karma_sphinx_theme_version": "0.0.8"}