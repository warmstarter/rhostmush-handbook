<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Execscript and external programs and scripts</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/epub.css" type="text/css" /> 
  </head><body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="execscript-and-external-programs-and-scripts">
<h1>Execscript and external programs and scripts</h1>
<div class="section" id="mush-variables">
<h2>Mush variables</h2>
<div class="section" id="built-in-variables">
<h3>Built in variables</h3>
<p>Variable                   Description
MUSH_PLAYER                player dbref#
MUSH_CAUSE                 cause dbref#
MUSH_CALLER                caller dbref#
MUSH_OWNER                 owner of player dbref#
MUSH_FLAGS                 space delimited list of flags on player
MUSH_TOGGLES               space delimited list of toggles on player
MUSH_OFLAGS                space delimited list of flags of player owner
MUSH_OTOGGLES              space delimited list of toggles of player owner
MUSHL_VARS                 space delimited list of MUSH attributes from player</p>
<blockquote>
<div><p>This is passed from the mush’s EXECSCRIPT_VARS attr</p>
</div></blockquote>
</div>
<div class="section" id="dynamic-variables">
<h3>Dynamic variables</h3>
<dl class="simple">
<dt>MUSHV_&lt;arg&gt;                &lt;arg&gt; variable passed from MUSHL_VARS</dt><dd><p>These are the attributes from EXECSCRIPT_VARS</p>
</dd>
</dl>
</div>
<div class="section" id="register-variables">
<h3>Register variables</h3>
<p>MUSHQ_&lt;arg&gt;                setq registers 0-9 and a-z
MUSHQN_&lt;arg&gt;               labels that are assigned the setq vars
MUSHN_&lt;arg&gt;                The labels that were defined by any register</p>
<blockquote>
<div><dl class="simple">
<dt>Note: they must be ASCII-7 clean and contain no</dt><dd><p>white spaces</p>
</dd>
</dl>
</div></blockquote>
</div>
</div>
<div class="section" id="set-object">
<h2>set object</h2>
<p>The script executed with execscript() will read in a file with the same name
as the script ending in ‘.set’.  This is a loader object that will set attributes
and registers back into the mush that you wish to pass from the script. The
fields are SPACE SEPARATED.  The values are NOT evaluated.</p>
<div class="section" id="the-format-of-the-fields-are">
<h3>The format of the fields are</h3>
<div class="section" id="id1">
<h4>Dynamic variables</h4>
<p>VARNAME        OWNER        CONTENTS (or leave null to clear)</p>
<div class="section" id="examples">
<h5>Examples</h5>
<p>SEX #123 Male
DESC #123 %r%tThis is a willow tree of unique description%r%rIt sways in the wind.
RED #123 This is the color %ch%crred%cn.
WIPETHISATTR #123
MULTILINE #123 This is a line
that continues on
because of the line feed (a control-M) on each line
on the lines above</p>
</div>
</div>
<div class="section" id="id2">
<h4>Register variables</h4>
<p>REGISTER       Q            CONTENTS (or leave null to clear)</p>
<div class="section" id="examples-the-last-example-clears-register-0">
<h5>Examples (The last example clears register 0)</h5>
<p>W Q This is stored in register W
1 Q This is stored in register 1
0 Q
foo QN this sets register with label ‘foo’</p>
</div>
</div>
</div>
</div>
<div class="section" id="example-bash-script">
<h2>Example bash script</h2>
<p>#!/bin/bash
echo “This was called by player ${MUSH_PLAYER} that is owned by ${MUSH_OWNER}”
echo “Displaying Registers:”
regs=”0 1 2 3 4 5 6 7 8 9 A B C D E F G H I J K L M N O P Q R S T U V W X Y Z”
for list in ${regs}
do</p>
<blockquote>
<div><p>eval echo “Register ${list}: ${MUSHQ_${list}}”</p>
</div></blockquote>
<p>done
echo “Displaying variables:”
for vars in ${MUSHL_VARS}
do</p>
<blockquote>
<div><p>eval echo “Variable ${vars}: ${MUSHV_${vars}}”</p>
</div></blockquote>
<p>done</p>
</div>
<div class="section" id="notes-and-warnings">
<h2>Notes and warnings</h2>
<p>While MUSHL_VARS are sanitized on what is allowable as a mush variable, this
is not necessarilly sanitized on what the calling script can fetch as a valid
variable.  Of note, you can not set environment variables that contain an
equals sign.  Be aware of this limitation.</p>
<p>Remember, MUSHL_VARS is the environment variable seen by the script.
This is EXECSCRIPT_VARS on the mush itself, that is the attribute set
on the target that contains the execscript() that is being executed.</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>